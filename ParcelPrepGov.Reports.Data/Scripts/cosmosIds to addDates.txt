ALTER TABLE [JobDatasets] ADD [CosmosId] nvarchar(36) NULL;

GO

ALTER TABLE [PackageDatasets] ADD [CosmosId] nvarchar(36) NULL;

GO

ALTER TABLE [ShippingContainerDatasets] ADD [CosmosId] nvarchar(36) NULL;

GO

ALTER TABLE [TrackPackageDatasets] ADD [CosmosId] nvarchar(36) NULL;

GO

CREATE INDEX [IX_JobDatasets_CosmosId] ON [JobDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_PackageDatasets_CosmosId] ON [PackageDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_ShippingContainerDatasets_CosmosId] ON [ShippingContainerDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_TrackPackageDatasets_CosmosId] ON [TrackPackageDatasets] ([CosmosId]);

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20201026152206_AddCosmosIds', N'3.1.6');

GO

DROP TABLE [PackageDatasets];

GO

DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[TrackPackageDatasets]') AND [c].[name] = N'CreateDate');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [TrackPackageDatasets] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [TrackPackageDatasets] DROP COLUMN [CreateDate];

GO

DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[ShippingContainerDatasets]') AND [c].[name] = N'CreateDate');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [ShippingContainerDatasets] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [ShippingContainerDatasets] DROP COLUMN [CreateDate];

GO

DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[JobDatasets]') AND [c].[name] = N'CreateDate');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [JobDatasets] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [JobDatasets] DROP COLUMN [CreateDate];

GO

DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[TrackPackageDatasets]') AND [c].[name] = N'ShippingCarrier');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [TrackPackageDatasets] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [TrackPackageDatasets] ALTER COLUMN [ShippingCarrier] nvarchar(24) NULL;

GO

DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[ShippingContainerDatasets]') AND [c].[name] = N'BinCode');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [ShippingContainerDatasets] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [ShippingContainerDatasets] ALTER COLUMN [BinCode] nvarchar(24) NULL;

GO

DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[JobDatasets]') AND [c].[name] = N'SubClientName');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [JobDatasets] DROP CONSTRAINT [' + @var5 + '];');
ALTER TABLE [JobDatasets] ALTER COLUMN [SubClientName] nvarchar(30) NULL;

GO

ALTER TABLE [JobContainerDatasets] ADD [CosmosId] nvarchar(36) NULL;

GO

ALTER TABLE [JobContainerDatasets] ADD [SiteName] nvarchar(24) NULL;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20201026213032_RemoveOldPackageDatasetEtc', N'3.1.6');

GO

CREATE TABLE [PackageDatasets] (
    [Id] int NOT NULL IDENTITY,
    [CosmosId] nvarchar(36) NULL,
    [SiteName] nvarchar(24) NULL,
    [PackageId] nvarchar(32) NULL,
    [ClientName] nvarchar(30) NULL,
    [SubClientName] nvarchar(30) NULL,
    [MailCode] nvarchar(1) NULL,
    [PackageStatus] nvarchar(24) NULL,
    [ProcessedDate] datetime2 NOT NULL,
    [LocalProcessedDate] datetime2 NOT NULL,
    [SiteId] nvarchar(36) NULL,
    [SiteZip] nvarchar(5) NULL,
    [SiteAddressLineOne] nvarchar(120) NULL,
    [SiteCity] nvarchar(30) NULL,
    [SiteState] nvarchar(2) NULL,
    [JobId] nvarchar(36) NULL,
    [ContainerId] nvarchar(36) NULL,
    [BinCode] nvarchar(24) NULL,
    [ShippingBarcode] nvarchar(100) NULL,
    [ShippingCarrier] nvarchar(24) NULL,
    [ShippingMethod] nvarchar(60) NULL,
    [ServiceLevel] nvarchar(60) NULL,
    [Zone] int NOT NULL,
    [Weight] decimal(18,2) NOT NULL,
    [Length] decimal(18,2) NOT NULL,
    [Width] decimal(18,2) NOT NULL,
    [Depth] decimal(18,2) NOT NULL,
    [TotalDimensions] decimal(18,2) NOT NULL,
    [Shape] nvarchar(24) NULL,
    [RequestCode] nvarchar(24) NULL,
    [DropSiteKeyValue] nvarchar(24) NULL,
    [MailerId] nvarchar(24) NULL,
    [Cost] decimal(18,2) NOT NULL,
    [Charge] decimal(18,2) NOT NULL,
    [BillingWeight] decimal(18,2) NOT NULL,
    [ExtraCost] nvarchar(100) NULL,
    [IsPoBox] bit NOT NULL,
    [IsUpsDas] bit NOT NULL,
    [IsOutside48States] bit NOT NULL,
    [IsOrmd] bit NOT NULL,
    [IsDuplicate] bit NOT NULL,
    [IsSaturday] bit NOT NULL,
    [IsDduScfBin] bit NOT NULL,
    [IsSecondaryContainerCarrier] bit NOT NULL,
    [IsQCRequired] bit NOT NULL,
    [AsnImportWebJobId] nvarchar(36) NULL,
    [BinGroupId] nvarchar(36) NULL,
    [BinMapGroupId] nvarchar(36) NULL,
    [RateId] nvarchar(36) NULL,
    [ServiceRuleId] nvarchar(36) NULL,
    [ServiceRuleGroupId] nvarchar(36) NULL,
    [ZoneMapGroupId] nvarchar(36) NULL,
    [FortyEightStatesGroupId] nvarchar(36) NULL,
    [UpsGeoDescriptorGroupId] nvarchar(36) NULL,
    [RecipientName] nvarchar(60) NULL,
    [AddressLine1] nvarchar(120) NULL,
    [AddressLine2] nvarchar(120) NULL,
    [AddressLine3] nvarchar(120) NULL,
    [City] nvarchar(30) NULL,
    [State] nvarchar(2) NULL,
    [Zip] nvarchar(5) NULL,
    [FullZip] nvarchar(10) NULL,
    [Phone] nvarchar(13) NULL,
    [ReturnName] nvarchar(60) NULL,
    [ReturnAddressLine1] nvarchar(120) NULL,
    [ReturnAddressLine2] nvarchar(120) NULL,
    [ReturnCity] nvarchar(30) NULL,
    [ReturnState] nvarchar(2) NULL,
    [ReturnZip] nvarchar(5) NULL,
    [ReturnPhone] nvarchar(13) NULL,
    [ZipOverrides] nvarchar(max) NULL,
    [ZipOverrideGroupIds] nvarchar(max) NULL,
    [DuplicatePackageIds] nvarchar(max) NULL,
    CONSTRAINT [PK_PackageDatasets] PRIMARY KEY ([Id])
);

GO

CREATE TABLE [PackageEventDatasets] (
    [Id] int NOT NULL IDENTITY,
    [CosmosId] nvarchar(36) NULL,
    [SiteName] nvarchar(24) NULL,
    [PackageDatasetId] int NOT NULL,
    [PackageId] nvarchar(32) NULL,
    [EventId] int NOT NULL,
    [EventType] nvarchar(24) NULL,
    [EventStatus] nvarchar(24) NULL,
    [Description] nvarchar(100) NULL,
    [EventDate] datetime2 NOT NULL,
    [LocalEventDate] datetime2 NOT NULL,
    [Username] nvarchar(32) NULL,
    [MachineId] nvarchar(32) NULL,
    CONSTRAINT [PK_PackageEventDatasets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_PackageEventDatasets_PackageDatasets_PackageDatasetId] FOREIGN KEY ([PackageDatasetId]) REFERENCES [PackageDatasets] ([Id]) ON DELETE CASCADE
);

GO

CREATE INDEX [IX_PackageEventDatasets_PackageDatasetId] ON [PackageEventDatasets] ([PackageDatasetId]);

GO

CREATE INDEX [IX_PackageEventDatasets_CosmosId] ON [PackageEventDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_PackageEventDatasets_SiteName] ON [PackageEventDatasets] ([SiteName]);

GO

CREATE INDEX [IX_PackageDatasets_PackageId] ON [PackageDatasets] ([PackageId]);

GO

CREATE INDEX [IX_PackageDatasets_ShippingBarcode] ON [PackageDatasets] ([ShippingBarcode]);

GO

CREATE INDEX [IX_PackageDatasets_CosmosId] ON [PackageDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_PackageDatasets_SiteName] ON [PackageDatasets] ([SiteName]);

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20201026215653_AddNewPackageDatasetEtc', N'3.1.6');

GO

CREATE TABLE [BinDatasets] (
    [Id] int NOT NULL IDENTITY,
    [CosmosId] nvarchar(36) NULL,
    [SiteName] nvarchar(24) NULL,
    [ActiveGroupId] nvarchar(36) NULL,
    [BinCode] nvarchar(24) NULL,
    [LabelListSiteKey] nvarchar(24) NULL,
    [LabelListDescription] nvarchar(100) NULL,
    [LabelListZip] nvarchar(5) NULL,
    [OriginPointSiteKey] nvarchar(24) NULL,
    [OriginPointDescription] nvarchar(100) NULL,
    [DropShipSiteKeyPrimary] nvarchar(24) NULL,
    [DropShipSiteDescriptionPrimary] nvarchar(100) NULL,
    [DropShipSiteAddressPrimary] nvarchar(120) NULL,
    [DropShipSiteCszPrimary] nvarchar(120) NULL,
    [ShippingCarrierPrimary] nvarchar(24) NULL,
    [ShippingMethodPrimary] nvarchar(60) NULL,
    [ContainerTypePrimary] nvarchar(24) NULL,
    [LabelTypePrimary] nvarchar(24) NULL,
    [RegionalCarrierHubPrimary] nvarchar(24) NULL,
    [DaysOfTheWeekPrimary] nvarchar(24) NULL,
    [ScacPrimary] nvarchar(24) NULL,
    [AccountIdPrimary] nvarchar(24) NULL,
    [BinCodeSecondary] nvarchar(24) NULL,
    [DropShipSiteKeySecondary] nvarchar(24) NULL,
    [DropShipSiteDescriptionSecondary] nvarchar(100) NULL,
    [DropShipSiteAddressSecondary] nvarchar(120) NULL,
    [DropShipSiteCszSecondary] nvarchar(120) NULL,
    [ShippingMethodSecondary] nvarchar(60) NULL,
    [ContainerTypeSecondary] nvarchar(24) NULL,
    [LabelTypeSecondary] nvarchar(24) NULL,
    [RegionalCarrierHubSecondary] nvarchar(24) NULL,
    [DaysOfTheWeekSecondary] nvarchar(24) NULL,
    [ScacSecondary] nvarchar(24) NULL,
    [AccountIdSecondary] nvarchar(24) NULL,
    CONSTRAINT [PK_BinDatasets] PRIMARY KEY ([Id])
);

GO

CREATE INDEX [IX_BinDatasets_ActiveGroupId] ON [BinDatasets] ([ActiveGroupId]);

GO

CREATE INDEX [IX_BinDatasets_BinCode] ON [BinDatasets] ([BinCode]);

GO

CREATE INDEX [IX_BinDatasets_CosmosId] ON [BinDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_BinDatasets_SiteName] ON [BinDatasets] ([SiteName]);

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20201026221026_AddBinDataset', N'3.1.6');

GO

DROP TABLE [JobContainerDatasets];

GO

DROP TABLE [ShippingContainerDatasets];

GO

DROP TABLE [TrackPackageDatasets];

GO

DROP TABLE [JobDatasets];

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20201027141747_RemoveOldDatasets', N'3.1.6');

GO

CREATE TABLE [JobDatasets] (
    [Id] int NOT NULL IDENTITY,
    [CosmosId] nvarchar(36) NULL,
    [SiteName] nvarchar(24) NULL,
    [JobBarcode] nvarchar(24) NULL,
    [SubClientName] nvarchar(30) NULL,
    [ManifestDate] nvarchar(10) NULL,
    [MarkUpType] nvarchar(24) NULL,
    [MarkUp] nvarchar(24) NULL,
    [Product] nvarchar(16) NULL,
    [PackageType] nvarchar(16) NULL,
    [PackageDescription] nvarchar(100) NULL,
    [Length] decimal(18,2) NOT NULL,
    [Width] decimal(18,2) NOT NULL,
    [Depth] decimal(18,2) NOT NULL,
    [MailTypeCode] nvarchar(16) NULL,
    [Username] nvarchar(32) NULL,
    [MachineId] nvarchar(32) NULL,
    CONSTRAINT [PK_JobDatasets] PRIMARY KEY ([Id])
);

GO

CREATE TABLE [ShippingContainerDatasets] (
    [Id] int NOT NULL IDENTITY,
    [CosmosId] nvarchar(36) NULL,
    [SiteName] nvarchar(24) NULL,
    [ContainerId] nvarchar(18) NULL,
    [BinCode] nvarchar(24) NULL,
    [BinCodeSecondary] nvarchar(24) NULL,
    [ShippingMethod] nvarchar(60) NULL,
    [ShippingCarrier] nvarchar(24) NULL,
    [ContainerType] nvarchar(24) NULL,
    [Grouping] nvarchar(2) NULL,
    [Weight] nvarchar(16) NULL,
    [UpdatedBarcode] nvarchar(100) NULL,
    [Cost] decimal(18,2) NOT NULL,
    [Charge] decimal(18,2) NOT NULL,
    [Zone] int NOT NULL,
    [Username] nvarchar(max) NULL,
    [MachineId] nvarchar(32) NULL,
    CONSTRAINT [PK_ShippingContainerDatasets] PRIMARY KEY ([Id])
);

GO

CREATE TABLE [TrackPackageDatasets] (
    [Id] int NOT NULL IDENTITY,
    [CosmosId] nvarchar(36) NULL,
    [SiteName] nvarchar(24) NULL,
    [PackageId] nvarchar(32) NULL,
    [ShippingCarrier] nvarchar(24) NULL,
    [TrackingNumber] nvarchar(100) NULL,
    [EventDate] datetime2 NOT NULL,
    [EventDescription] nvarchar(120) NULL,
    [EventLocation] nvarchar(120) NULL,
    CONSTRAINT [PK_TrackPackageDatasets] PRIMARY KEY ([Id])
);

GO

CREATE TABLE [JobContainerDatasets] (
    [Id] int NOT NULL IDENTITY,
    [CosmosId] nvarchar(36) NULL,
    [SiteName] nvarchar(24) NULL,
    [JobDatasetId] int NOT NULL,
    [JobBarcode] nvarchar(24) NULL,
    [NumberOfContainers] int NOT NULL,
    [Weight] nvarchar(16) NULL,
    CONSTRAINT [PK_JobContainerDatasets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_JobContainerDatasets_JobDatasets_JobDatasetId] FOREIGN KEY ([JobDatasetId]) REFERENCES [JobDatasets] ([Id]) ON DELETE CASCADE
);

GO

CREATE INDEX [IX_JobContainerDatasets_JobDatasetId] ON [JobContainerDatasets] ([JobDatasetId]);

GO

CREATE INDEX [IX_JobContainerDatasets_JobBarcode] ON [JobContainerDatasets] ([JobBarcode]);

GO

CREATE INDEX [IX_JobContainerDatasets_SiteName] ON [JobContainerDatasets] ([SiteName]);

GO

CREATE INDEX [IX_JobContainerDatasets_CosmosId] ON [JobContainerDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_JobDatasets_JobBarcode] ON [JobDatasets] ([JobBarcode]);

GO

CREATE INDEX [IX_JobDatasets_SiteName] ON [JobDatasets] ([SiteName]);

GO

CREATE INDEX [IX_JobDatasets_CosmosId] ON [JobDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_ShippingContainerDatasets_ContainerId] ON [ShippingContainerDatasets] ([ContainerId]);

GO

CREATE INDEX [IX_ShippingContainerDatasets_SiteName] ON [ShippingContainerDatasets] ([SiteName]);

GO

CREATE INDEX [IX_ShippingContainerDatasets_CosmosId] ON [ShippingContainerDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_TrackPackageDatasets_PackageId] ON [TrackPackageDatasets] ([PackageId]);

GO

CREATE INDEX [IX_TrackPackageDatasets_TrackingNumber] ON [TrackPackageDatasets] ([TrackingNumber]);

GO

CREATE INDEX [IX_TrackPackageDataSets_SiteName] ON [TrackPackageDataSets] ([SiteName]);

GO

CREATE INDEX [IX_TrackPackageDatasets_CosmosId] ON [TrackPackageDatasets] ([CosmosId]);

GO

CREATE INDEX [IX_PackageEventDatasets_PackageId] ON [PackageEventDatasets] ([PackageId]);

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20201027141850_AddNewDatasets', N'3.1.6');

GO

ALTER TABLE [BinDatasets] ADD [DatasetCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [BinDatasets] ADD [CosmosCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [JobDatasets] ADD [DatasetCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [JobDatasets] ADD [CosmosCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [JobContainerDatasets] ADD [DatasetCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [JobContainerDatasets] ADD [CosmosCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [PackageDatasets] ADD [DatasetCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [PackageDatasets] ADD [CosmosCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [PackageEventDatasets] ADD [DatasetCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [PackageEventDatasets] ADD [CosmosCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [ShippingContainerDatasets] ADD [DatasetCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [ShippingContainerDatasets] ADD [CosmosCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [TrackPackageDatasets] ADD [DatasetCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

ALTER TABLE [TrackPackageDatasets] ADD [CosmosCreateDate] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20201028203711_AddDates', N'3.1.6');

GO

